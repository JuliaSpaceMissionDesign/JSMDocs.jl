<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gravity · Julia Space Mission Design</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><script src="../../../assets/init.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Julia Space Mission Design logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Julia Space Mission Design</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Ecosystem</span><ul><li><a class="tocitem" href="../../../ecosystem/roadmap/">Roadmap</a></li></ul></li><li><span class="tocitem">Guidelines</span></li><li><span class="tocitem">Encyclopedia</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../time/">Time</a></li><li><a class="tocitem" href="../frames/">Frames</a></li><li class="is-active"><a class="tocitem" href>Gravity</a><ul class="internal"><li><a class="tocitem" href="#Ephemeris-Restricted-N-Body-Problem"><span>Ephemeris Restricted N-Body Problem</span></a></li><li><a class="tocitem" href="#Spherical-Harmonics"><span>Spherical Harmonics</span></a></li><li><a class="tocitem" href="#Constant-Density-Polyhedron"><span>Constant Density Polyhedron</span></a></li></ul></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Encyclopedia</a></li><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>Gravity</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gravity</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaSpaceMissionDesign/JSMDocs.jl/blob/master/docs/src/encyclopedia/astro/gravity.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Gravitational-Models"><a class="docs-heading-anchor" href="#Gravitational-Models">Gravitational Models</a><a id="Gravitational-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Gravitational-Models" title="Permalink"></a></h1><h2 id="Ephemeris-Restricted-N-Body-Problem"><a class="docs-heading-anchor" href="#Ephemeris-Restricted-N-Body-Problem">Ephemeris Restricted N-Body Problem</a><a id="Ephemeris-Restricted-N-Body-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Ephemeris-Restricted-N-Body-Problem" title="Permalink"></a></h2><p>Astrodynamics is mainly concerned with the study of the motion of artificial objects. Therefore, simplifications to the Full N-Body Problem can be introduced. In fact, assuming that the mass of the test particle <span>$i$</span> is such that <span>$M_i \ll M_j$</span>, where <span>$j$</span> are the other bodies in the model, its gravitational effect on the other bodies may be neglected. </p><p align="center">
    <img src="https://user-images.githubusercontent.com/56970512/193584643-0f9e6b0b-c6ca-4eb4-8db3-24ba80b12a91.png" alt="Image" width="400" />
</p><p>Moreover, it is more useful to describe the motion of the particle interest with respect to some central body, <span>$\mathcal{P}_k$</span>, instead of a generic point, <span>$\mathcal{O}$</span>. Therefore, the relative formulation of the Restricted N-Body can be expressed as:</p><p class="math-container">\[\begin{equation*}
    \boldsymbol{\ddot{R}}_{ki} = - \frac{\mu_k}{R_{ki}^3} \,\boldsymbol{R}_{ki} + \sum_{\substack{j=1 \\ j\neq i,k}}^{\text{N}}\, \mu_j\left(\frac{\boldsymbol{R}_{ij}}{{R}_{ij}^3} - \frac{\boldsymbol{R}_{kj}}{{R}_{kj}^3} \right)
\end{equation*}\]</p><p>where the motion of the particle <span>$\mathcal{P}_i$</span>, with respect to the central body <span>$\mathcal{P}_k$</span>, under the gravitational influence of the point masses <span>$\mathcal{P}_j$</span> is modelled.</p><p>If the relative position vector <span>$\boldsymbol{R}_{kj}$</span>, that represents the location of the <span>$j$</span>-th perturbing body with respect to the central body is obtained from high-fidelity ephemerides, recovering the Ephemeris Restricted N-Body Problem. Note that here the relative position vector <span>$\boldsymbol{R}_{ij}$</span> is computed by vector subtraction as:</p><p class="math-container">\[\begin{equation*}
    \boldsymbol{R}_{ji} = \boldsymbol{R}_{kj} - \boldsymbol{R}_{ki}
\end{equation*}\]</p><p>and represents the location of the perturbing body <span>$\mathcal{P}_j$</span> with respect to the particle of interest, <span>$\mathcal{P}_i$</span></p><h2 id="Spherical-Harmonics"><a class="docs-heading-anchor" href="#Spherical-Harmonics">Spherical Harmonics</a><a id="Spherical-Harmonics-1"></a><a class="docs-heading-anchor-permalink" href="#Spherical-Harmonics" title="Permalink"></a></h2><p>A possibile way to represent the exterior gravitational field of non-spherical objects is by exploiting a spherical harmonics expansion of its field. </p><p class="math-container">\[V(r,\lambda,\varphi) = \sum_{m=0}^N\sum_{n=0}^N V_{nm}(r,\lambda,\varphi)\]</p><p>where </p><p class="math-container">\[\begin{equation*}
V_{nm}(r,\lambda,\varphi) = \frac{\mu}{a}\left(\frac{a}{r}\right)^{n+1}\left(\bar{C}_{nm}\cos(m\lambda) + \bar{S}_{nm}\sin(m\lambda)\right)\,\bar{P}_{nm}(\sin\varphi)
\end{equation*}\]</p><p>with dimensionless coefficients <span>$\bar{C}_{nm}$</span> and <span>$\bar{S}_{nm}$</span>. Where <span>$a$</span> is the semimajor axis of the reference ellipsoid belonging to the model, <span>$\mu$</span> the gravitational parameter and <span>$\bar{P}_{nm}$</span> the fully normalized associated Legendre polynomials of degree <span>$n$</span> and order <span>$m$</span>.</p><p>Then, denoting the cartesian coordinates of the satellite position <span>$(x,y,z)$</span> in the body frame of the body, their relation with the spherical coordinates used here are:</p><p class="math-container">\[\begin{align*}
    x &amp;= r\cos\varphi\cos\lambda \\
    y &amp;= r\cos\varphi\sin\lambda \\
    z &amp;= r\sin\varphi
\end{align*}\]</p><p>where here <span>$r\geq 0$</span>, <span>$\varphi\in [-\pi/2, \pi/2]$</span> and <span>$\lambda\in[0, 2\pi]$</span>. In the literature instead of <span>$\varphi$</span>, mostly the <strong>colatitude</strong> <span>$\vartheta=\pi/2-\varphi$</span> is used. Here the <strong>latitude</strong> is preferred because its domain coincides with the range of the inverse trigonometric functions arcsin and most notably arctan. As fourth cartesian coordinate we make use of the radius of the parallel of latitude:</p><p class="math-container">\[\begin{equation*}
    \rho = \sqrt{x^2 + y^2} = r\cos\varphi
\end{equation*}\]</p><p>Moreover, it is convenient to define the following normalized cartesian coordinates:</p><p class="math-container">\[\begin{equation*}
    \bar{x} = \frac{x}{r},\quad \bar{y} = \frac{y}{r},\, \quad \bar{z} = \frac{z}{r}=\sin\varphi,\, \quad \bar{\rho} = \frac{\rho}{r}=\cos\varphi
\end{equation*}\]</p><p>Note that outside an arbitrary small neighborhood of the poles the transformation:</p><p class="math-container">\[\begin{equation*}
    \varphi \mapsto \bar{z}=\sin\varphi,\quad \frac{\partial}{\partial\varphi} = \cos\varphi\frac{\partial}{\partial\bar{z}} = \bar{\rho}\frac{\partial}{\partial\bar{z}}
\end{equation*}\]</p><p>is strictly monotonous and continuously differentiable. Thus, we may replace the coordinate <span>$\varphi$</span> by <span>$\bar{z} = \cos\varphi$</span>.</p><p>Therefore, to transform the potential gradient from spherical to cartesian coordinates, it is possible to apply:</p><p class="math-container">\[\begin{align*}
    r\frac{\partial V}{\partial x} &amp;= \bar{x}\left(r\frac{\partial V}{\partial r} - \bar{z}\frac{\partial V}{\partial \bar{z}}\right) - \bar{y}\left(\frac{1}{\bar{\rho}^2}\frac{\partial V}{\partial \lambda}\right) \\
    r\frac{\partial V}{\partial y} &amp;= \bar{y}\left(r\frac{\partial V}{\partial r} - \bar{z}\frac{\partial V}{\partial \bar{z}}\right) + \bar{x}\left(\frac{1}{\bar{\rho}^2}\frac{\partial V}{\partial \lambda}\right) \\
    r\frac{\partial V}{\partial z} &amp;= \bar{z}\left(r\frac{\partial V}{\partial r} - \bar{z}\frac{\partial V}{\partial \bar{z}}\right) + \frac{\partial V}{\partial \bar{z}} \\
\end{align*}\]</p><p>where:</p><p class="math-container">\[\begin{align*}
\frac{\partial V_{nm}}{\partial\lambda} &amp;= m\,\frac{\mu}{a}\left(\frac{a}{r}\right)^{n+1}(-\bar{C}_{nm}\sin(m\lambda) + \bar{S}_{nm}\cos(m\lambda))\,\bar{P}_{nm}(\bar{z}) \\ 
\frac{\partial V_{nm}}{\partial r} &amp;= -\frac{\mu}{a^2}(n+1)\left(\frac{a}{r}\right)^{n+2}(\bar{C}_{nm}\cos(m\lambda) + \bar{S}_{nm}\sin(m\lambda))\,\bar{P}_{nm}(\bar{z}) \\ 
\frac{\partial V_{nm}}{\partial \bar{z}} &amp;= \frac{\mu}{a}\left(\frac{a}{r}\right)^{n+1}\left(\bar{C}_{nm}\cos(m\lambda) + \bar{S}_{nm}\sin(m\lambda)\right)\,\frac{d\bar{P}_{nm}(\bar{z})}{d\bar{z}}
\end{align*}\]</p><h3 id="Fully-Normalized-ALF"><a class="docs-heading-anchor" href="#Fully-Normalized-ALF">Fully Normalized ALF</a><a id="Fully-Normalized-ALF-1"></a><a class="docs-heading-anchor-permalink" href="#Fully-Normalized-ALF" title="Permalink"></a></h3><p>The recursion of fully normalized functions are:</p><p class="math-container">\[\begin{align*}
    \bar{P}_{00} &amp;= 1, \quad \bar{P}_{mm} = \nu_{mm}\sqrt{1-\bar{z}^2}\,\bar{P}_{m-1, m-1} \\ 
    \bar{P}_{m-1, m} &amp; = 0\, \quad \bar{P}_{nm} = \nu_{nm}\left(\bar{z}\bar{P}_{n-1, m} - \frac{\bar{P}_{n-2, m}}{\nu_{n-1,m}}\right)
\end{align*}\]</p><p>with factors:</p><p class="math-container">\[\begin{align*}
    \nu_{00} = \sqrt{3}, \quad \nu_{mm} = \sqrt{\frac{2m+1}{2m}}, \quad\nu_{nm} = \sqrt{\frac{(2n-1)(2n+1)}{(n-m)(n+m)}}
\end{align*}\]</p><h3 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h3><ul><li><p>Gerstl, Michael. <em>Computing the Earth gravity field with spherical harmonics.</em> From Nano to Space. Springer, Berlin, Heidelberg, 2008. 277-294.</p></li><li><p>Barthelmes, Franz. <em>Definition of functionals of the geopotential and their calculation from spherical harmonic models: theory and formulas used by the calculation service of the International Centre for Global Earth Models (ICGEM)</em>, http://icgem.gfz-potsdam.de (2009): 1-32.</p></li></ul><h2 id="Constant-Density-Polyhedron"><a class="docs-heading-anchor" href="#Constant-Density-Polyhedron">Constant Density Polyhedron</a><a id="Constant-Density-Polyhedron-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-Density-Polyhedron" title="Permalink"></a></h2><p>Among the different available techniques, one of the most effective for the computation of the gravitational field of a body is the constant density polyhedron model. This models has been largely applied in literature and consider the fact that the potential of a constant density attractor can be derived from:</p><p class="math-container">\[\mathcal{U} = G\rho\int_V \frac{1}{r}\,dV\]</p><p>where <span>$V$</span> is the overall volume and <span>$r$</span> the modulus of the vector <span>$\mathbf{r}$</span> between the field point and the infinitesimal mass element <span>$dm = \rho dV$</span>. Then, defining the unit vector:</p><p class="math-container">\[\hat{r} = \frac{\mathbf{r}}{r}\]</p><p>and exploiting the Gauss divergence theorem</p><p class="math-container">\[\mathcal{U} = \frac{1}{2}G\rho\int_V(\nabla \cdot\hat{r}) \,dV = \frac{1}{2}G\rho\int_S(\hat{n}\cdot\hat{r})\, dS\]</p><p>where <span>$\hat{n}$</span> is the unit normal to the infinitesimal surface. This can be transformed, for a polyhedron model with a certain number of faces <span>$n_f$</span> to:</p><p class="math-container">\[\mathcal{U} = \frac{1}{2}G\rho\sum_{faces} \hat{n}_f \cdot \mathbf{r}_f\int_S\frac{1}{r}dS\]</p><p>with <span>$\mathbf{r}_f$</span> the vector from the field point to any point of the plane in which lies the tetrahedron’s face. Exploiting properties of the polygons and defining <span>$\hat{n}_{e}^f$</span> the unit normal to tetrahedron’s edge <span>$e$</span> lying on the face’s <span>$e$</span> plane and <span>$\mathbf{r}_e^f$</span> the vector from the field point to a generic point on the edge <span>$e$</span> extension, then:</p><p class="math-container">\[\mathcal{U} = \frac{1}{2}G\rho\sum_{faces}\sum_{edges}(\mathbf{r}_f\cdot\hat{n}_f\hat{n}_{e}^f\cdot\mathbf{r}_{e}^fL_e^f) - \frac{1}{2}G\rho\sum_{faces}(\mathbf{r}_f\cdot\hat{n}_f\hat{n}_f\cdot\mathbf{r}_f\omega_f)\]</p><p>where here: </p><p class="math-container">\[L_e^f = \ln\frac{l_1+ l_2+ e}{l_1+ l_2 -e}\]</p><p>with <span>$l_1$</span> the distance from the field point to the first end of the edge, <span>$l_2$</span> the distance from the field point to the second end of the edge and e the length of the edge. Here, also <span>$\omega_f$</span> is intended to the be solid angle subtended by the face S, when viewed from the field point and defined as:</p><p class="math-container">\[\omega_f = \int_S\frac{\Delta z}{r^3}\, dS\]</p><p>Therefore, defining the dyads:</p><p class="math-container">\[\mathbb{E} =\hat{n}_f\hat{n}_{e}^{f_1} + \hat{n}_f\hat{n}_{e}^{f_2}\quad\text{and}\quad \mathbb{F} = \hat{n}_f\hat{n}_f\]</p><p>we have:</p><p class="math-container">\[\begin{align*}
    \mathcal{U} &amp;= \frac{1}{2}G\rho\sum_{edges} \mathbf{r}_e\cdot\mathbb{E}_e\cdot\mathbf{r}_eL_e - \frac{1}{2}G\rho\sum_{faces}\mathbf{r}_f\cdot\mathbb{F}_f\cdot\mathbf{r}_f\omega_f \\
    \nabla\mathcal{U} &amp;= -G\rho\sum_{edges} \mathbb{E}_e\cdot\mathbf{r}_eL_e + G\rho\sum_{faces}\mathbb{F}_f\cdot\mathbf{r}_f\omega_f \\
    \nabla^2\mathcal{U} &amp;= - G\rho\sum_{faces}\omega_f \\
\end{align*}\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../frames/">« Frames</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 27 May 2023 16:58">Saturday 27 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
